#!/bin/bash
source $OPENSHIFT_CARTRIDGE_SDK_BASH

# generate the password
echo "Generating the initial admin password for LiveOak"

password=$(generate_password)

echo "$password" > $OPENSHIFT_LIVEOAK_DIR/env/OPENSHIFT_LIVEOAK_INITIAL_PASSWORD

client_result ""
client_result "LiveOak Cartridge installed. Please make note of the credentials:"
client_result ""
client_result "  Username:         admin"
client_result "  Initial Password: $password"
client_result ""
client_result "IMPORTANT: PLEASE MAKE NOTE OF THIS PASSWORD. YOU WILL NEED IT TO LOG INTO LIVEOAK"
client_result ""

# install the OpenJDK binary from our own github repo
# NOTE: we have to use our own since we cut down the size for a headless environment
mkdir $HOME/openjdk
pushd $HOME/openjdk > /dev/null
  wget https://github.com/mwringe/openshift-liveoak-jdk/archive/master.zip > /dev/null
  unzip master.zip
  mv openshift-liveoak-jdk-master/* .
  rmdir openshift-liveoak-jdk-master
  rm master.zip
popd > /dev/null
